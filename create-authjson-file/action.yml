name: "create auth.json file for composer"
description: "creates auth.json file needed for composer"
author: "eDACT"
inputs:
  registry_url:
    description: "URL of the registry, no trailing slashes"
    default: "github.com"
    required: false
  location:
    description: "location for generated file, no trailing slashes"
    default: src
    required: false
  deploy_token:
    description: "deploy token for private packages"
    required: true
runs:
  # using: "docker"
  # image: "Dockerfile"
  using: "composite"
  steps:
    - shell: bash
      run: |
        npm -h
        npx -h
        # makes the script existing once an error occours
        set -euo pipefail

        cd ./${{ inputs.location }}

        JSON_FMT='{"github-oauth":{"%s": "%s"} }\n'
        printf "$JSON_FMT" "${{ inputs.registry_url }}" "${{ inputs.deploy_token }}" > auth.json
